<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/a.jpg">
  <title>crypto之曼彻斯特编码 | Facker007's blog</title>
  <meta name="author" content="Facker007" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="crypto" />
  
  <meta name="description" content="通过对数字信号进行编码来表示数据不归零编码、曼切斯特编码、差分曼切斯特编码都是其编码方式 差分曼彻斯特编码是一种使用中位转变来计时的编码方案。数据通过在数据位开始处加一转变来表示。令牌环局域网就利用差分曼彻斯特编码方案。在 每个时钟周期的中间都有一次电平跳变，这个跳变做同步之用。 在每个时钟周期的起始处：跳变则说明该比特是0，不跳变则说明该比特是1。差分曼彻斯特编码的优点为：收发双方可以根据编码自">
<meta property="og:type" content="article">
<meta property="og:title" content="crypto之曼彻斯特编码">
<meta property="og:url" content="http://example.com/2021/12/21/crypto%E4%B9%8B%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81/index.html">
<meta property="og:site_name" content="Facker007&#39;s blog">
<meta property="og:description" content="通过对数字信号进行编码来表示数据不归零编码、曼切斯特编码、差分曼切斯特编码都是其编码方式 差分曼彻斯特编码是一种使用中位转变来计时的编码方案。数据通过在数据位开始处加一转变来表示。令牌环局域网就利用差分曼彻斯特编码方案。在 每个时钟周期的中间都有一次电平跳变，这个跳变做同步之用。 在每个时钟周期的起始处：跳变则说明该比特是0，不跳变则说明该比特是1。差分曼彻斯特编码的优点为：收发双方可以根据编码自">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/a.jpg">
<meta property="article:published_time" content="2021-12-21T11:58:00.000Z">
<meta property="article:modified_time" content="2021-12-23T00:11:07.336Z">
<meta property="article:author" content="Facker007">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/a.jpg">
<meta name="twitter:site" content="@null">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" type="text/css" media="all">
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight.min.css" type="text/css" media="all">
  
  
  <link rel="stylesheet" id="fontawe-css" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css" media="all">
  <link rel="stylesheet" id="nprogress-css" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" type="text/css" media="all">
  
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
  
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-dark.min.css" type="text/css" media="all">
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/qrcode_js@1.0.0/qrcode.min.js"></script>
  
<meta name="generator" content="Hexo 5.3.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <div class="nav-toggle"><a class="kratos-nav-toggle js-kratos-nav-toggle"><i></i></a></div>
            <header id="kratos-header-section">
                <div class="container">
                    <div class="nav-header">
                        <div class="color-logo"><a href="/">Facker007&#39;s blog</a></div>
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                                    
                                
                                    
                                        <li><a href="/archives/"><i class="fa fa-file"></i>档案馆</a></li>
                                    
                                
                                    
                                        <li><a href="/friends/"><i class="fa fa-paw"></i>好伙伴</a></li>
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>Facker007&#39;s blog</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div class="row">
                    
        <div id="main">
            <section class="col-md-8">
    <article>
        <div class="kratos-hentry kratos-post-inner clearfix">
            <header class="kratos-entry-header">
                <h1 class="kratos-entry-title text-center">crypto之曼彻斯特编码</h1>
                
                <div class="kratos-post-meta text-center">
                    <span>
                        <i class="fa fa-calendar"></i> 2021-12-21
                        <i class="fa fa-folder"></i> 分类 
                        <i class="fa fa-user"></i> 作者 Facker007
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~6.41K
                        
                        字
                        
                    </span>
                </div>
            </header>
            <div class="kratos-post-content">
                <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                    本文最后编辑于 <time datetime="1640218267336"></time> 前，其中的内容可能需要更新。
                </div>
                
                <hr />
                <p>通过对数字信号进行编码来表示数据<br><code>不归零编码、曼切斯特编码、差分曼切斯特编码都是其编码方式</code></p>
<p>差分曼彻斯特编码是一种使用中位转变来计时的编码方案。数据通过在数据位开始处加一转变来表示。令牌环局域网就利用差分曼彻斯特编码方案。<br>在 每个时钟周期的中间都有一次电平跳变，这个跳变做同步之用。 在每个时钟周期的起始处：跳变则说明该比特是0，不跳变则说明该比特是1。<br>差分曼彻斯特编码的优点为：收发双方可以根据编码自带的时钟信号来保持同步，无需专门传递同步信号的线路，因此成本低；缺点为：实现技术复杂。</p>
<p>曼彻斯特编码（Manchester Encoding），也叫做相位编码(PE)，是一个同步时钟编码技术，被物理层使用来编码一个同步位流的时钟和数据。曼彻斯特编码被用在以太网媒介系统中。曼彻斯特编码提供一个简单的方式给编码简单的二进制序列而没有长的周期没有转换级别，因而防止时钟同步的丢失，或来自低频率位移在贫乏补偿的模拟链接位错误。在这个技术下，实际上的二进制数据被传输通过这个电缆，不是作为一个序列的逻辑1或0来发送的（技术上叫做反向不归零制(NRZ)）。相反地，这些位被转换为一个稍微不同的格式，它通过使用直接的二进制编码有很多的优点。</p>
<p><strong>差分曼彻斯特编码</strong>，每位中间的跳变仅提供时钟定时，而用每位开始时有无跳变表示”0”或”1”，有跳变为”0”，无跳变为”1”。</p>
<p><strong>曼彻斯特编码</strong>的编码规则是:在信号位中电平从低到高跳变表示1，在信号位中电平从高到低跳变表示0。</p>
<p>这个图就单独的表示曼彻斯特编码的0,1原理图<br>从低到高就是0，从高到低就是1<br><img src="1.png" alt="1.png"></p>
<p>看曼彻斯特就简单的分成一段一段看他上升还是下降就可以表示出来</p>
<p>而差分曼彻斯特要看他前一个信号的值，比如这图里第一个就是不跳就用1表示，第二个信号从底下升到高处就跳了表示0，第三个也是不跳用1表示，第4个同理也是1，第5个跳了就是0。而差分的意思应该就是要把一段内拆成两段只看前一段，而后一半是用来同步时钟用的，顺便可以传输下一个数据来表示是否有跳<br><img src="3.png" alt="3.png"></p>
<p>再来看下三种信号的区别<br><img src="2.png" alt="2.png"></p>
<p>在来说下802.3曼彻斯特和标准曼彻斯特的区别，就是编码后的字符的区别。<br>第一种G. E. Thomas, Andrew S. Tanenbaum1949年提出的，它规定0是由低-高的电平跳变表示，1是高-低的电平跳变。<br>按此规则有：</p>
<ul>
<li>编码0101（即0x5），表示原数据为00；</li>
<li>编码1001（0x9）表示10；</li>
<li>编码0110（0x6）表示01；</li>
<li>编码1010（0xA）表示11。</li>
</ul>
<p>第二种IEEE 802.4（令牌总线）和低速版的IEEE 802.3（以太网）中规定, 按照这样的说法, 低-高电平跳变表示1, 高-低的电平跳变表示0。</p>
<ul>
<li>编码0101（0x5）表示11；</li>
<li>编码1001（0x9）表示01；</li>
<li>编码0110（0x6）表示10；</li>
<li>编码1010（0xA）表示00；</li>
</ul>
<p>顺便推荐一个可解，差分曼彻斯特和标准曼彻斯特和802.3曼彻斯特<br><a target="_blank" rel="noopener" href="http://www.pc6.com/softview/SoftView_606143.html">http://www.pc6.com/softview/SoftView_606143.html</a><br><img src="tool.png" alt="tool.png"></p>
<h4 id="BUUOJ-Crypto-传感器"><a href="#BUUOJ-Crypto-传感器" class="headerlink" title="BUUOJ-Crypto-传感器"></a>BUUOJ-Crypto-传感器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5555555595555A65556AA696AA6666666955</span><br><span class="line">这是某压力传感器无线数据包解调后但未解码的报文(hex)</span><br><span class="line">  </span><br><span class="line">已知其ID为0xFED31F，请继续将报文完整解码，提交hex。</span><br><span class="line"></span><br><span class="line">提示1：曼联</span><br></pre></td></tr></table></figure>
<p>去网上抄了个脚本，这个脚本的转换其实就是应用了802.3曼彻斯特的规则取了1和3位，题目里给了id的话，可以看flag解出来是否含有id？吗，相当于校验是否正确的一个功能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cipher&#x3D;&#39;5555555595555A65556AA696AA6666666955&#39;</span><br><span class="line">def iee(cipher):</span><br><span class="line">    tmp&#x3D;&#39;&#39;</span><br><span class="line">    for i in range(len(cipher)):</span><br><span class="line">        a&#x3D;bin(eval(&#39;0x&#39;+cipher[i]))[2:].zfill(4)   #补齐四位方便取1和3位</span><br><span class="line">        tmp&#x3D;tmp+a[1]+a[3]      #加上1和3位，就是应用了802.3的規則，或者定义一个字典替换也可以</span><br><span class="line">        print(tmp)</span><br><span class="line">    plain&#x3D;[hex(int(tmp[i:i+8][::-1],2))[2:] for i in range(0,len(tmp),8)]</span><br><span class="line">    print(&#39;&#39;.join(plain).upper())</span><br><span class="line"></span><br><span class="line">iee(cipher)</span><br><span class="line"></span><br><span class="line"># tmp&#x3D;&quot;111111111111111101111111110010111111100000100110000010101010101010011111&quot;</span><br><span class="line"># flag&#x3D;&quot;&quot;</span><br><span class="line"># for i in range(0,len(tmp),8):</span><br><span class="line">#     # plain&#x3D;hex(int(tmp[i:i+8][::-1],2))[2:]</span><br><span class="line">#     # print(&#39;&#39;.join(plain).upper())</span><br><span class="line">#     flag+&#x3D;((hex(int(tmp[i:i+8][::-1],2)))[2:])</span><br><span class="line"># print(flag.upper())</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>或者用工具也可以直接出<br><img src="tool.png" alt="tool.png"></p>
<hr>
<h4 id="CISCN-全国大学生信息安全竞赛-2016-传感器2"><a href="#CISCN-全国大学生信息安全竞赛-2016-传感器2" class="headerlink" title="CISCN(全国大学生信息安全竞赛) 2016 传感器2"></a>CISCN(全国大学生信息安全竞赛) 2016 传感器2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">现有某ID为0xFED31F的压力传感器，已知测得压力为45psi时的未解码报文为：</span><br><span class="line">5555555595555A65556A5A96AA666666A955 压力为30psi时的未解码报文为： 5555555595555A65556A9AA6AA6666665665 请给出ID为0xFEB757的传感器在压力为25psi时的解码后报文，提交hex。 </span><br><span class="line">注：其他测量读数与上一个传感器一致。 </span><br><span class="line">tips：flag是flag&#123;破译出的明文&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>根据进制转换，转成十进制差5的话就是11</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">0xFED31F</span><br><span class="line">	45psi fffffed31f635055f8</span><br><span class="line">	30psi fffffed31f425055d7</span><br><span class="line">	找到两个psi差的地方，相减，括号内是十进制的数</span><br><span class="line">	f8(248)-d7(215)&#x3D;0x21(33)</span><br><span class="line">	63(99)-42(66)&#x3D;0x21(33)</span><br><span class="line">15差33的话，5就是差11。除3即可</span><br><span class="line">15   33</span><br><span class="line">5    11</span><br><span class="line"></span><br><span class="line">0xFEB757</span><br><span class="line">	CC&#x3D;215-11</span><br><span class="line">	37&#x3D;66-11</span><br><span class="line">    		拿差值替换掉</span><br><span class="line">	25psi   fffffed31f375055CC</span><br><span class="line">    		把检验位直接替换掉</span><br><span class="line">    		fffffeb757375055cc</span><br><span class="line">    		转成大写</span><br><span class="line">    		FFFFFEB757375055CC</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="CISCN-全国大学生信息安全竞赛-2017-传感器1"><a href="#CISCN-全国大学生信息安全竞赛-2017-传感器1" class="headerlink" title="CISCN(全国大学生信息安全竞赛) 2017 传感器1"></a>CISCN(全国大学生信息安全竞赛) 2017 传感器1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">已知ID为0x8893CA58的温度传感器的未解码报文为：3EAAAAA56A69AA55A95995A569AA95565556 此时有另一个相同型号的传感器，其未解码报文为：3EAAAAA56A69AA556A965A5999596AA95656 请解出其ID，提交flag&#123;hex（不含0x）&#125;。</span><br></pre></td></tr></table></figure>
<p>先把给的字符串转成以一位字符串转为4位2进制的01数字。然后在以两位分割，因为差分曼彻斯特编码后面的数据是同步时钟和决定下一个传输的数据的，所以加进去之后。还要等于cc，让他继续下一步的操作，判断是否为01就是是否有跳。bintohex函数就是把01数据转为字符串。可以看下面另一个脚本的单独操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import re </span><br><span class="line"> </span><br><span class="line">#hex1 &#x3D; &#39;AAAAA56A69AA55A95995A569AA95565556&#39; # #  0x8893CA58</span><br><span class="line">hex1 &#x3D; &#39;AAAAA56A69AA556A965A5999596AA95656&#39;</span><br><span class="line"></span><br><span class="line">def bintohex(s1):</span><br><span class="line">    s2 &#x3D; &#39;&#39;</span><br><span class="line">    s1 &#x3D; re.findall(&#39;.&#123;4&#125;&#39;,s1)</span><br><span class="line">    print (&#39;每一个hex分隔:&#39;,s1)</span><br><span class="line">    for i in s1:</span><br><span class="line">        s2 +&#x3D; str(hex(int(i,2))).replace(&#39;0x&#39;,&#39;&#39;)</span><br><span class="line"> </span><br><span class="line">    print (&#39;ID:&#39;,s2)</span><br><span class="line"> </span><br><span class="line">def diffmqst(s):</span><br><span class="line">    s1 &#x3D; &#39;&#39;</span><br><span class="line">    s &#x3D; re.findall(&#39;.&#123;2&#125;&#39;,s)</span><br><span class="line">    cc &#x3D; &#39;01&#39;</span><br><span class="line">    for i in s:</span><br><span class="line">        if i &#x3D;&#x3D; cc:</span><br><span class="line">            s1 +&#x3D; &#39;0&#39;</span><br><span class="line">        else:</span><br><span class="line">            s1 +&#x3D; &#39;1&#39;</span><br><span class="line">        cc &#x3D; i  # 差分加上cc &#x3D; i</span><br><span class="line"> </span><br><span class="line">    print (&#39;差分曼切斯特解码:&#39;,s1)</span><br><span class="line">    bintohex(s1)</span><br><span class="line"> </span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    bin1 &#x3D; bin(int(hex1,16))[2:]</span><br><span class="line">    diffmqst(bin1)</span><br></pre></td></tr></table></figure>
<p><img src="4.png" alt="4.png"></p>
<p>在贴一个脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">str1 &#x3D; &#39;3EAAAAA56A69AA556A965A5999596AA95656&#39;</span><br><span class="line"></span><br><span class="line">s &#x3D; &#39;&#39;</span><br><span class="line">for i in xrange(len(str1)&#x2F;2):</span><br><span class="line">    ch &#x3D; str1[i*2 : i*2+2]</span><br><span class="line">    b &#x3D; bin(int(ch, 16))[2:]</span><br><span class="line">    b &#x3D; &#39;0&#39; * (8-len(b)) + b</span><br><span class="line">    s +&#x3D; b</span><br><span class="line"></span><br><span class="line">print &#39;s:&#39;+s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r &#x3D; &#39;&#39;</span><br><span class="line">#因为此处除了前六位都是10和01，很明显是曼彻斯特，因而把前六位去掉即可看到正确的结果</span><br><span class="line">s &#x3D; s[6:]</span><br><span class="line">print &#39;s:&#39;+s</span><br><span class="line">for i in xrange(len(s)&#x2F;2-1):</span><br><span class="line">    c &#x3D; s[i*2+1 : i*2+3]</span><br><span class="line">    if c &#x3D;&#x3D; &#39;11&#39; or c&#x3D;&#x3D;&#39;00&#39;:</span><br><span class="line">        r +&#x3D; &#39;1&#39;</span><br><span class="line">    else:</span><br><span class="line">        r +&#x3D; &#39;0&#39;</span><br><span class="line"></span><br><span class="line">print &quot;r:&quot;+r</span><br><span class="line"></span><br><span class="line">ret &#x3D;&#39;&#39;</span><br><span class="line">for i in xrange(len(r)&#x2F;8):</span><br><span class="line">    c &#x3D; r[i*8 : i*8+8]</span><br><span class="line">    print str(r[i*8 : i*8+8]) + &#39; &#39; + c</span><br><span class="line">    ret +&#x3D; hex(int(c, 2 ))[2:].upper()</span><br><span class="line"></span><br><span class="line">print ret</span><br></pre></td></tr></table></figure>
<p>左边去掉5个字符，右边去掉4个字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str&#x3D;&quot;10000000001001001101100010000100010110101011111100110100000100011001&quot;</span><br><span class="line">a&#x3D;0</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(0,len(str)&#x2F;4):</span><br><span class="line">    # print(str[0+(i*4):4+(i*4)])</span><br><span class="line">    # a+&#x3D;1</span><br><span class="line">    flag+&#x3D;hex(int(str[0+(i*4):4+(i*4)],2))[2:]</span><br><span class="line">    # print(hex(int(str[0+(i*4):4+(i*4)],2))[2:])</span><br><span class="line">    # print(str[4:8])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="5.png" alt="5.png"></p>
<p>或者就是直接上工具<br><img src="6.png" alt="6.png"></p>
<h4 id="CISCN-全国大学生信息安全竞赛-2017-传感器2"><a href="#CISCN-全国大学生信息安全竞赛-2017-传感器2" class="headerlink" title="CISCN(全国大学生信息安全竞赛) 2017 传感器2"></a>CISCN(全国大学生信息安全竞赛) 2017 传感器2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">已知ID为0x8893CA58的温度传感器未解码报文为：3EAAAAA56A69AA55A95995A569AA95565556</span><br><span class="line"></span><br><span class="line">为伪造该类型传感器的报文ID（其他报文内容不变），请给出ID为0xDEADBEEF的传感器1的报文校验位（解码后hex），以及ID为0xBAADA555的传感器2的报文校验位（解码后hex），并组合作为flag提交。</span><br><span class="line"></span><br><span class="line">例如，若传感器1的校验位为0x123456，传感器2的校验位为0xABCDEF，则flag为flag&#123;123456ABCDEF&#125;。</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0024D 8893CA58 41 81</span><br><span class="line">0024D 8845ABF3 41 19</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">把上一题的数据拿过来查看，格式应该是0024+id+41+xx(校验)</span><br><span class="line">其他格式都是固定的，即可判别最后两位为校验</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>把题目给的数据，分开找到校验的值。如果是按一位=4位，即为8位，可以尝试crc8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bin(int(&#39;A&#39;,16))</span><br><span class="line">&#39;0b1010&#39;</span><br></pre></td></tr></table></figure>
<p><img src="7.png" alt="7.png"></p>
<p>可以看到就是等于校验值的<br><img src="8.png" alt="8.png"></p>
<p>直接就拿题目要求的替换掉id即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0xDEADBEEF</span><br><span class="line">024DDEADBEEF41</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xBAADA555</span><br><span class="line">024DBAADA55541</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; hex(c8(binascii.unhexlify(&#39;024DDEADBEEF41&#39;)))</span><br><span class="line">&#39;0xb5&#39;</span><br><span class="line">&gt;&gt;&gt; hex(c8(binascii.unhexlify(&#39;024DBAADA55541&#39;)))</span><br><span class="line">&#39;0x15&#39;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://www.ip33.com/crc.html">或者在线解也可以</a><br><img src="9.png" alt="9.png"></p>
<p><strong>参考链接：</strong><br>[1] <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37790902/article/details/79616450">https://blog.csdn.net/qq_37790902/article/details/79616450</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://blog.csdn.net/Enderman_xiaohei/article/details/104331317">https://blog.csdn.net/Enderman_xiaohei/article/details/104331317</a></p>
<p>[3] <a target="_blank" rel="noopener" href="http://www.pc6.com/softview/SoftView_606143.html">http://www.pc6.com/softview/SoftView_606143.html</a></p>
<p>[4]<a target="_blank" rel="noopener" href="https://blog.csdn.net/zz_Caleb/article/details/89331290">https://blog.csdn.net/zz_Caleb/article/details/89331290</a></p>
<p>[5]<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/27827585">https://zhuanlan.zhihu.com/p/27827585</a></p>
<p>[6]<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43165101/article/details/97395191">https://blog.csdn.net/qq_43165101/article/details/97395191</a></p>

            </div>
            
                <div class="kratos-copyright text-center clearfix">
                    <h5>本作品采用 <a rel="license nofollow" target="_blank" href="http://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
                </div>
            
            <footer class="kratos-entry-footer clearfix">
                
                    <div class="post-like-donate text-center clearfix" id="post-like-donate">
                    
                    
                        <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                        <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://example.com/2021/12/21/crypto%E4%B9%8B%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://example.com/2021/12/21/crypto%E4%B9%8B%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81/";
            const title         = "「crypto之曼彻斯特编码」";
            const excerpt       = `通过对数字信号进行编码来表示数据不归零编码、曼切斯特编码、差分曼切斯特编码都是其编码方式
差分曼彻斯特编码是一种使用中位转变来计时的编码方案。数据通过在数据位开始处加一转变来表示。令牌环局域网就利用差分曼彻斯特编码方案。在 每个时钟周...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                    
                    </div>
                
                <div class="footer-tag clearfix">
                    <div class="pull-left">
                    <i class="fa fa-tags"></i>
                        <a class="tag-none-link" href="/tags/crypto/" rel="tag">crypto</a>
                    </div>
                    <div class="pull-date">
                    <span>最后编辑：2021-12-23</span>
                    </div>
                </div>
            </footer>
        </div>
        
            <nav class="navigation post-navigation clearfix" role="navigation">
                
                <div class="nav-previous clearfix">
                    <a title=" 2021-深育杯" href="/2021/11/21/2021-深育杯/">&lt; 上一篇</a>
                </div>
                
                
                <div class="nav-next clearfix">
                    <a title=" buuctf-misc系列2(33-48)" href="/2022/01/02/buuctf-misc系列2-33-48/">下一篇 &gt;</a>
                </div>
                
            </nav>
        
        
    </article>
</section>
        </div>
                
            <section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
                
                    <aside id="krw-about" class="widget widget-kratos-about clearfix">
    
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.webp" />
        </div>
    </div>
    <div class="textwidget">
        
            <p class="text-center"></p>
        
    </div>
</aside>
                
                    <!-- Moved to about.ejs -->
                
                    

                
                    
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/CE/" style="font-size: 0.63em;">CE</a> <a href="/tags/bugku/" style="font-size: 0.77em;">bugku</a> <a href="/tags/buuctf/" style="font-size: 0.63em;">buuctf</a> <a href="/tags/buuctf-misc/" style="font-size: 0.63em;">buuctf-misc</a> <a href="/tags/crypto/" style="font-size: 0.67em;">crypto</a> <a href="/tags/ctf-%E6%AF%94%E8%B5%9B%E5%90%88%E9%9B%86/" style="font-size: 0.63em;">ctf-比赛合集</a> <a href="/tags/game-hack/" style="font-size: 0.63em;">game-hack</a> <a href="/tags/misc/" style="font-size: 0.67em;">misc</a> <a href="/tags/noi-oj/" style="font-size: 0.6em;">noi-oj</a> <a href="/tags/pip%E6%BA%90-docker%E6%BA%90/" style="font-size: 0.6em;">pip源&docker源</a> <a href="/tags/pwn/" style="font-size: 0.67em;">pwn</a> <a href="/tags/re/" style="font-size: 0.8em;">re</a> <a href="/tags/shark%E6%81%92/" style="font-size: 0.7em;">shark恒</a> <a href="/tags/vulnhub/" style="font-size: 0.73em;">vulnhub</a> <a href="/tags/%E5%85%B3%E4%BA%8E%E6%88%91/" style="font-size: 0.6em;">关于我</a> <a href="/tags/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2/" style="font-size: 0.67em;">墨者学院</a> <a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 0.63em;">攻防世界</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 0.6em;">数论</a>
      </div>
  </aside>

                
                    
  <aside id="krw-posts" class="widget widget-kratos-poststab">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2022/01/17/vmp%E5%A3%B3%E5%86%85%E7%88%86%E7%A0%B4%E4%B8%8E%E5%AF%BB%E6%B3%A8%E5%86%8C%E7%A0%81/"><i class="fa  fa-book"></i> vmp壳内爆破与寻注册码</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/01/15/%E5%9F%BA%E7%A1%80%E6%95%B0%E8%AE%BA%E7%AC%AC%E4%B8%80%E8%AF%BE-%E8%A3%B4%E8%9C%80%E5%BC%95%E7%90%86/"><i class="fa  fa-book"></i> 基础数论第一课-裴蜀引理</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/01/14/%E5%85%B3%E9%94%AEcall%E5%92%8C%E5%85%B3%E9%94%AE%E8%B7%B3%EF%BC%88eax%E5%86%B3%E5%AE%9A%EF%BC%89/"><i class="fa  fa-book"></i> 关键call和关键跳（eax决定）</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/01/14/dll%E6%B3%A8%E5%85%A5pvc%E4%BF%AE%E6%94%B9%E9%98%B3%E5%85%89%E6%95%B0/"><i class="fa  fa-book"></i> dll注入pvc修改阳光数</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/01/14/C%E9%81%8D%E5%8E%86cs1-6%E6%88%BF%E9%97%B4%E4%BA%BA%E7%89%A9/"><i class="fa  fa-book"></i> C遍历cs1.6房间人物</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

                
            </section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        <li><a href="mailto:1969434293@qq.com"><i class="fa fa-envelope"></i></a></li>
                        
                        
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/facker007"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2022 Facker007 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Made with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by <a href="https://candinya.com" target="_blank" rel="nofollow">Candinya</a>.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            
                        </div>
                        <div>
                            <li><a href="https://beian.miit.gov.cn" rel="external nofollow" target="_blank">浙ICP备2021004749号</a></li>
                            <li><a href="http://www.beian.gov.cn" rel="external nofollow" target="_blank"><img src="/images/psr.webp" width="12" height="12">浙公网安备 33030402001126号</a></li>
                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>
<script>const notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));</script>

    <div>
        <canvas id="snow"></canvas>
        <script async type="text/javascript" src="/js/snow.min.js"></script>
    </div>

<script async src="/js/candy.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="2498562945"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>


    <script defer src="/js/kr-dark.min.js"></script>


    </body>
</html>